# DGCNN Inference Configuration
# This configuration file contains the model architecture and inference settings.
# These settings MUST match the architecture used during training.

# Model Architecture Parameters (DO NOT MODIFY unless using a different checkpoint)
model:
  name: ParticleNet
  # Input features: Number of rechit features per point
  # Must match the features in your HDF5 data files
  input_features: 14
  
  # Output classes: [background, signal]
  output_classes: 2
  
  # Convolutional layer parameters: [k_neighbors, [channel1, channel2, channel3]]
  # k_neighbors: Number of nearest neighbors for dynamic graph construction
  conv_params:
    - [16, [64, 64, 64]]
    - [16, [128, 128, 128]]
    - [16, [256, 256, 256]]
  
  # Fully connected layer parameters: [dropout_rate, num_neurons]
  fc_params:
    - [0.1, 256]

# Inference Settings
inference:
  # Batch size for inference (adjust based on GPU memory)
  batch_size: 64
  
  # Number of data loader workers
  num_workers: 4
  
  # Device: 'cuda', 'cuda:0', 'cpu', or 'auto' (auto-detect)
  device: auto
  
  # Output mode: 'labels', 'probabilities', or 'both'
  output_mode: both

# Weights Configuration
weights:
  # Path to the model weights file (relative to this config file or absolute)
  path: weights/dgcnn_weights.pth

# Data Configuration (for your reference - modify as needed for your data)
data:
  # Expected rechit feature names (in order)
  rechit_feature_names:
    - rechit_eta
    - rechit_phi
    - rechit_energy
    - rechit_time
    - rechit_layer
    - rechit_x
    - rechit_y
    - rechit_z
    - rechit_rho
    - rechit_pt
    - rechit_fraction
    - rechit_chi2
    - rechit_flags
    - rechit_size
  
  # Position features used for k-NN graph construction
  # These should be the first 3 features or specified indices
  position_feature_indices: [0, 1, 2]  # [eta, phi, energy] used as spatial coords

